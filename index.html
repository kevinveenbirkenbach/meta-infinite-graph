<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Meta Infinity 3D – Test</title>
  <style>
    body { margin: 0; overflow: hidden; }
    #3d-graph { width: 100vw; height: 100vh; display: block; }
    #sidebar {
      position: absolute; top: 10px; right: 10px;
      width: 300px; max-height: 90vh; overflow-y: auto;
      background: rgba(255,255,255,0.9); padding: 10px;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <div id="3d-graph"></div>
  <div id="sidebar"><p>Klicke einen Knoten an, um Details zu sehen.</p></div>

  <!-- Bibliotheken -->
  <script src="https://unpkg.com/three/build/three.min.js"></script>
  <script src="https://unpkg.com/3d-force-graph/dist/3d-force-graph.min.js"></script>

  <script>
    // Warte, bis alles geladen ist
    window.addEventListener('load', () => {
      // *** Testdaten ***
      const data = {
        nodes: [
          { id: 'A', title: 'Role A', description: 'Die Beschreibung von A' },
          { id: 'B', title: 'Role B', description: 'Die Beschreibung von B' },
          { id: 'C', title: 'Role C', description: 'Die Beschreibung von C' }
        ],
        links: [
          { source: 'A', target: 'B', type: 'run_after' },
          { source: 'A', target: 'C', type: 'dependency' },
          { source: 'B', target: 'C', type: 'run_after' }
        ]
      };

      // *** Graph initialisieren ***
      const Graph = ForceGraph3D()
        (document.getElementById('3d-graph'))
        .graphData(data)
        .nodeLabel(d => `${d.id}: ${d.title}`)   // Einfacher Tooltip
        .nodeAutoColorBy('type')                 // färbt nach 'type' (hier: undefined → gleiche Farbe)
        .linkDirectionalArrowLength(3)
        .linkDirectionalArrowRelPos(1)
        // Klick auf Knoten → Sidebar füllen
        .onNodeClick(node => {
          document.getElementById('sidebar').innerHTML = `
            <h2>${node.id} – ${node.title}</h2>
            <p>${node.description}</p>
            <p><strong>Verknüpfte Knoten:</strong></p>
            <ul>
              ${data.links
                .filter(l => l.source === node.id)
                .map(l => `<li>${l.type}: ${l.target}</li>`).join('')}
            </ul>`;
        });
    });
  </script>
</body>
</html>
